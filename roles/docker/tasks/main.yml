---
- name: determine if docker is installed
  command: which docker
  register: docker_installed
  ignore_errors: true
  changed_when: false

- name: install docker
  shell: curl https://releases.rancher.com/install-docker/{{ docker_version }}.sh | sh
  when: docker_installed is failed

- name: make sure docker is running
  service: name=docker state=started enabled=true